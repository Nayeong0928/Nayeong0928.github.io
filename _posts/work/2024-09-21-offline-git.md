---
title: 인터넷이 안 되는 환경에서 git으로 협업하기
author: qoskdud0928
date: 2024-09-21
category: work
layout: post
---

# Question_

인터넷이 되지 않는 환경으로 출장을 가게 되었다. 두 명이서 C# 클라이언트 프로그램의 추가 요구사항을 개발하는 업무였고, 결합도가 높은 프로그램이었기 때문에 Spring MVC처럼 각자 코드를 작성해서 합치는 방법은 쓸 수 없었다. 서로의 수정사항을 계속 공유하는 것이 필수적인 상황인데 인터넷이 되지 않으니 대처가 필요했다.

사수분의 노트북을 원격저장소 삼아 리파지토리를 만들고, 변경이 일어날 때마다 내 소스파일을 사수분의 노트북으로 옮겨(블루투스나 usb를 사용해서 파일 형태로 옮기는 방식) 기존의 git 소스에 합쳐 커밋하는 방식으로 형상관리를 진행하자는 이야기가 나왔다.

usb에 변경사항이 취합된다는 점이 원격저장소의 역할과 비슷해 보였고, 노트북이 아니라 최종 소스가 있는 usb를 원격저장소로 설정하는 것이 더 좋을 것 같다는 아이디어가 떠올랐다.

직접 설정해본 결과, usb만 꽂으면 인터넷 연결 환경과 동일하게 clone/pull/push가 사용 가능하다는 걸 확인했다.


# Answer_

## usb 저장소를 bare 저장소로 전환

기존에 프로젝트를 회사 서버의 원격 저장소에 관리하고 있었다. 우선 기존의 프로젝트 폴더를 usb 저장소로 복사한 다음, usb 저장소의 프로젝트를 다음과 같은 방법으로 bare 저장소로 바꿔주면 된다.

- `cd [usb 저장소]`
- `mv .git ../리파지토리명.git`
- `cd ../리파지토리명.git`
- `git config --bool core.bare true`

지금까지 git의 원격 저장소가 어떤 구조를 가지고 있는지 확인해볼 일이 없어서 bare 저장소 파일 구조를 보고 처음에는 당황했다. 테스트용으로 새로 커밋한 파일이 usb 저장소 폴더에는 없는 것이다. bare 저장소는 메타 데이터를 저장하기 때문에 파일을 push해도 저장소에서 추가한 파일을 눈으로 확인할 수는 없었다. 그렇지만 사수분의 노트북에서 usb 저장소로 pull을 받자 제대로 수정사항이 업로드되었다는 것을 확인할 수 있었다. clone/push/pull 방법은 다음과 같다.

### clone

- `git clone [usb 저장소]`
- `git remote add [원격저장소 별칭] [usb 저장소]`

### push

- `git add .`
- `git commit -m “커밋메시지”`
- `git push [원격저장소 별칭] [브랜치명]`

### pull

- `git pull [원격 저장소 별칭] [브랜치명]`

&nbsp;

## 기존 원격 저장소와의 공유

위 사항을 진행하면서 한가지 빠뜨린 점이 있었다. 출장용 노트북을 예전에 미리 세팅해두느라 git pull을 받은지 몇 주가 지난 상태로 위의 사항을 진행한 것이었다. `git remote show` 명령어로 원격 저장소를 확인하니 기존에 사용하던 원격저장소와 usb 원격저장소가 모두 떴다. `git pull origin master`로 원격저장소의 최신사항을 받은 다음, usb 저장소에 commit&push하자 정상적으로 동작했다. 동작의 정확한 원리는 더 조사해봐야겠지만 아래의 그림과 같은 구조로 두 개의 원격저장소에서 동시에 형상관리가 가능한 것 같다.

![](https://velog.velcdn.com/images/qoskdud0928/post/bb07c113-2e8d-440c-a900-81e2dec47424/image.png)



